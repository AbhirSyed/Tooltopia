{% extends "base.html" %}

{% block content %}
<div class="product-detail-container">
    <div class="product-image">
        <img src="{{ url_for('static', filename=product.image) }}" alt="{{ product.name }}">
    </div>
    <div class="product-info">
        <h1>{{ product.name }}</h1>
        <p class="product-price">{{ product.price | currency }}</p>
        <p class="product-description">{{ product.description }}</p>
        <p class="in-stock">In stock: {{ product.stock }}</p>
        <button class="add-to-cart" data-product-id="{{ product.id }}">Add to Cart</button>
    </div>
    
</div>
<div id="cart-notification" style="display: none;">Product added to cart!</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        var addToCartButtons = document.querySelectorAll('.add-to-cart');
        addToCartButtons.forEach(function(button) {
            button.addEventListener('click', function() {
                var productId = button.dataset.productId;
                var xhr = new XMLHttpRequest();
                xhr.open('POST', '/add_to_cart');
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.onload = function() {
                    if (xhr.status === 200) {
                        var notification = document.getElementById('cart-notification');
                        notification.style.display = 'block';
                        setTimeout(function() {
                            notification.style.display = 'none';
                        }, 3000);
                    }
                };
                xhr.send('product_id=' + productId);
            });
        });
    });
    </script>
    </div>
</div>
{% endblock %}
